<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∞—è –ó–º–µ–π–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0d2818 0%, #1b4332 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%231b4332"/><circle cx="20" cy="20" r="3" fill="%230d2818" opacity="0.3"/><circle cx="50" cy="40" r="2" fill="%230d2818" opacity="0.3"/><circle cx="80" cy="20" r="4" fill="%230d2818" opacity="0.3"/><circle cx="30" cy="70" r="3" fill="%230d2818" opacity="0.3"/><circle cx="70" cy="80" r="2" fill="%230d2818" opacity="0.3"/><circle cx="90" cy="60" r="3" fill="%230d2818" opacity="0.3"/></svg>');
        }
        
        .container {
            max-width: 900px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        
        .menu-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #d90429, #ff6b6b);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 2000;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .menu-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }
        
        .menu-toggle.active {
            background: linear-gradient(45deg, #06d6a0, #4cc9f0);
        }
        
        .top-menu {
            position: fixed;
            top: -400px;
            left: 0;
            width: 100%;
            background-color: rgba(13, 40, 24, 0.98);
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            border-bottom: 3px solid #ffd166;
            z-index: 1500;
            transition: top 0.5s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .top-menu.active {
            top: 0;
        }
        
        .menu-content {
            max-width: 900px;
            width: 100%;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            padding: 20px 0;
        }
        
        .menu-section {
            background: rgba(27, 67, 50, 0.9);
            border-radius: 10px;
            padding: 20px;
            flex: 1;
            min-width: 250px;
            max-width: 400px;
            border: 2px solid #ffd166;
        }
        
        .menu-section h3 {
            color: #ffd166;
            margin-bottom: 15px;
            font-size: 1.3rem;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #ffd166;
        }
        
        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .menu-btn {
            background: linear-gradient(to right, #0d2818, #1b4332);
            border: 2px solid #06d6a0;
            border-radius: 8px;
            color: white;
            padding: 12px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .menu-btn:hover {
            background: linear-gradient(to right, #06d6a0, #4cc9f0);
            color: #0d2818;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(6, 214, 160, 0.4);
        }
        
        .menu-btn.active {
            background: linear-gradient(to right, #06d6a0, #4cc9f0);
            color: #0d2818;
            box-shadow: 0 0 10px rgba(6, 214, 160, 0.7);
        }
        
        .menu-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .menu-control-btn {
            flex: 1;
            padding: 10px;
            font-size: 0.9rem;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            width: 100%;
            background: rgba(13, 40, 24, 0.8);
            border-radius: 15px;
            border: 3px solid #d90429;
            box-shadow: 0 0 15px rgba(217, 4, 41, 0.4);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: #ffd166;
            text-shadow: 0 0 10px rgba(255, 209, 102, 0.7);
            background: linear-gradient(45deg, #d90429, #ffd166);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #a0a0c0;
            margin-bottom: 10px;
        }
        
        .christmas-text {
            color: #d90429;
            font-weight: bold;
            font-size: 1.3rem;
            text-shadow: 0 0 5px rgba(217, 4, 41, 0.5);
        }
        
        .game-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            width: 100%;
        }
        
        .game-board {
            position: relative;
            border: 3px solid #d90429;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(217, 4, 41, 0.5);
            background-color: #0d2818;
            overflow: hidden;
            width: 400px;
            height: 400px;
        }
        
        #game-canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        .border-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .border-line {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .score-info {
            background-color: rgba(13, 40, 24, 0.9);
            border-radius: 10px;
            padding: 20px;
            width: 400px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            border: 2px solid #ffd166;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        
        .score-container {
            background: linear-gradient(to right, #0d2818, #1b4332);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #ffd166;
            width: 100%;
        }
        
        .score-title {
            font-size: 1.2rem;
            color: #a0a0c0;
            margin-bottom: 5px;
        }
        
        .score-value {
            font-size: 3rem;
            font-weight: bold;
            color: #ffd166;
        }
        
        .high-score {
            margin-top: 10px;
            font-size: 1.1rem;
            color: #d90429;
        }
        
        .current-grid-size {
            font-size: 1rem;
            color: #ffd166;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            background: rgba(27, 67, 50, 0.8);
            border-radius: 8px;
            width: 100%;
            border: 1px solid #06d6a0;
        }
        
        .instructions-btn-container {
            margin-top: 10px;
            text-align: center;
            width: 100%;
        }
        
        #instructions-btn {
            width: 100%;
            background: linear-gradient(to right, #06d6a0, #4cc9f0);
            border: 1px solid #06d6a0;
            padding: 12px;
        }
        
        .instructions-panel {
            position: fixed;
            top: 0;
            right: -350px;
            width: 320px;
            height: 100vh;
            background-color: rgba(13, 40, 24, 0.95);
            padding: 25px;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.5);
            border-left: 3px solid #ffd166;
            z-index: 1000;
            transition: right 0.4s ease;
            overflow-y: auto;
        }
        
        .instructions-panel.active {
            right: 0;
        }
        
        .instructions-panel h3 {
            color: #ffd166;
            margin-bottom: 20px;
            font-size: 1.8rem;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 2px solid #ffd166;
        }
        
        .instructions-panel ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .instructions-panel li {
            margin-bottom: 15px;
            padding-left: 30px;
            position: relative;
            line-height: 1.5;
            color: #fff;
        }
        
        .instructions-panel li:before {
            content: "üéÑ";
            position: absolute;
            left: 0;
            top: 0;
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #d90429;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 5px;
            z-index: 10;
            display: none;
        }
        
        .game-over h2 {
            font-size: 3.5rem;
            color: #d90429;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(217, 4, 41, 0.7);
            text-align: center;
        }
        
        .game-over p {
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: #ffd166;
            text-align: center;
        }
        
        .start-hint {
            font-size: 1.2rem;
            color: #4cc9f0;
            margin-top: 10px;
            text-align: center;
            padding: 10px;
            background: rgba(13, 40, 24, 0.8);
            border-radius: 8px;
            border: 1px solid #4cc9f0;
            display: none;
        }
        
        .game-over-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            width: 80%;
        }
        
        footer {
            margin-top: 30px;
            text-align: center;
            color: #ffd166;
            font-size: 1.1rem;
            padding: 20px;
            width: 100%;
            background: rgba(13, 40, 24, 0.9);
            border-radius: 10px;
            border: 2px solid #d90429;
            font-weight: bold;
        }
        
        .college-name {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }
        
        .college-subtitle {
            font-size: 0.9rem;
            color: #a0a0c0;
        }
        
        @media (max-width: 768px) {
            .game-board {
                width: 350px;
                height: 350px;
            }
            
            .score-info {
                width: 350px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .menu-toggle {
                top: 10px;
                right: 10px;
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .menu-content {
                flex-direction: column;
                align-items: center;
            }
            
            .menu-section {
                width: 100%;
                max-width: 350px;
            }
            
            .instructions-panel {
                width: 100%;
                right: -100%;
            }
            
            .instructions-panel.active {
                right: 0;
            }
            
            .game-over h2 {
                font-size: 2.5rem;
            }
            
            .game-over p {
                font-size: 1.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .game-board {
                width: 300px;
                height: 300px;
            }
            
            .score-info {
                width: 300px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–Ω—é -->
    <button class="menu-toggle" id="menu-toggle">‚ò∞</button>
    
    <!-- –í—ã–¥–≤–∏–∂–Ω–æ–µ –º–µ–Ω—é —Å–≤–µ—Ä—Ö—É -->
    <div class="top-menu" id="top-menu">
        <div class="menu-content">
            <div class="menu-section">
                <h3>–†–ê–ó–ú–ï–† –°–ï–¢–ö–ò</h3>
                <div class="menu-buttons">
                    <button class="menu-btn grid-size-btn" id="menu-grid-15">15 √ó 15</button>
                    <button class="menu-btn grid-size-btn active" id="menu-grid-20">20 √ó 20</button>
                    <button class="menu-btn grid-size-btn" id="menu-grid-25">25 √ó 25</button>
                </div>
            </div>
            
            <div class="menu-section">
                <h3>–£–ü–†–ê–í–õ–ï–ù–ò–ï –ò–ì–†–û–ô</h3>
                <div class="menu-buttons">
                    <button class="menu-btn" id="menu-start-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                    <button class="menu-btn" id="menu-pause-btn">–ü–∞—É–∑–∞</button>
                    <button class="menu-btn" id="menu-restart-btn">–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫</button>
                </div>
            </div>
            
            <div class="menu-section">
                <h3>–ù–ê–°–¢–†–û–ô–ö–ò</h3>
                <div class="menu-buttons">
                    <button class="menu-btn" id="menu-instructions-btn">üìò –ö–∞–∫ –∏–≥—Ä–∞—Ç—å?</button>
                    <div class="menu-controls">
                        <button class="menu-control-btn" id="menu-music-toggle">üîä –ú—É–∑—ã–∫–∞ –í–ö–õ</button>
                        <button class="menu-control-btn" id="menu-volume-down">üîâ –¢–∏—à–µ</button>
                        <button class="menu-control-btn" id="menu-volume-up">üîä –ì—Ä–æ–º—á–µ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <header>
            <h1>üéÑ –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∞—è –ó–º–µ–π–∫–∞ üéÑ</h1>
            <p class="subtitle">–°—ä–µ–¥–∞–π—Ç–µ —Ñ—Ä—É–∫—Ç—ã, —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ—Å—å –≤ —Ä–∞–∑–º–µ—Ä–∞—Ö –∏ –∏–∑–±–µ–≥–∞–π—Ç–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π!</p>
            <p class="christmas-text">Jingle Bells, Jingle Bells, Jingle all the way! üéµ</p>
        </header>
        
        <div class="game-center">
            <div class="game-board">
                <canvas id="game-canvas"></canvas>
                <div class="border-overlay" id="border-overlay"></div>
                <div class="game-over" id="game-over">
                    <h2>–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê</h2>
                    <p id="final-score">–í–∞—à —Å—á–µ—Ç: 0</p>
                    <div class="game-over-buttons">
                        <button id="restart-btn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                        <div class="start-hint" id="start-hint">–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å</div>
                    </div>
                </div>
            </div>
            
            <div class="score-info">
                <div class="score-container">
                    <div class="score-title">–¢–ï–ö–£–©–ò–ô –°–ß–ï–¢</div>
                    <div class="score-value" id="score">0</div>
                    <div class="high-score">–†–µ–∫–æ—Ä–¥: <span id="high-score">0</span></div>
                </div>
                
                <div class="current-grid-size" id="current-grid-size">–†–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏: 20 √ó 20</div>
                
                <div class="instructions-btn-container">
                    <button id="instructions-btn">üìò –ö–∞–∫ –∏–≥—Ä–∞—Ç—å?</button>
                </div>
            </div>
        </div>
        
        <footer>
            <div class="college-name">–í–æ–ª–æ–≥–æ–¥—Å–∫–∏–π –∫–æ–ª–ª–µ–¥–∂ —Å–≤—è–∑–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π</div>
            <div class="college-subtitle">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞ "–ó–º–µ–π–∫–∞"</div>
        </footer>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π -->
    <div class="instructions-panel" id="instructions-panel">
        <button class="close-btn" id="close-instructions">√ó</button>
        <h3>üéÆ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h3>
        <ul>
            <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª–∞–≤–∏—à–∏ —Å–æ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–º–µ–π–∫–æ–π</li>
            <li>–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ WASD (–∞–Ω–≥–ª–∏–π—Å–∫–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞)</li>
            <li>–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –§–¶–´–í (—Ä—É—Å—Å–∫–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞)</li>
            <li>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏: 15√ó15, 20√ó20 –∏–ª–∏ 25√ó25</li>
            <li>–°–æ–±–∏—Ä–∞–π—Ç–µ —Ä–∞–∑–Ω–æ—Ü–≤–µ—Ç–Ω—ã–µ —Ñ—Ä—É–∫—Ç—ã, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –¥–ª–∏–Ω—É –∑–º–µ–π–∫–∏</li>
            <li>–ö–∞–∂–¥—ã–π —Ñ—Ä—É–∫—Ç –¥–∞–µ—Ç 10 –æ—á–∫–æ–≤</li>
            <li>–ò–∑–±–µ–≥–∞–π—Ç–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π —Å–æ —Å—Ç–µ–Ω–∞–º–∏ –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º —Ö–≤–æ—Å—Ç–æ–º</li>
            <li>–ò–≥—Ä–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ —Å –∫–∞–∂–¥—ã–º–∏ 50 –æ—á–∫–∞–º–∏</li>
            <li>–ü—Ä–æ–±–µ–ª - –ø–∞—É–∑–∞/—Å—Ç–∞—Ä—Ç, Enter - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã</li>
            <li>–ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å —Ä–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–æ–π –º—É–∑—ã–∫–æ–π! üéÑ</li>
        </ul>
    </div>

    <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏ -->
    <audio id="background-music" loop preload="auto">
        <source src="https://assets.mixkit.co/music/preview/mixkit-jingle-bells-311.mp3" type="audio/mpeg">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç.
    </audio>

    <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∑–≤—É–∫–∞ –∫–Ω–æ–ø–æ–∫ -->
    <audio id="button-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-bell-notification-933.mp3" type="audio/mpeg">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç.
    </audio>

    <script>
        // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã DOM
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('high-score');
        const finalScoreElement = document.getElementById('final-score');
        const gameOverScreen = document.getElementById('game-over');
        const startHint = document.getElementById('start-hint');
        const restartBtn = document.getElementById('restart-btn');
        const backgroundMusic = document.getElementById('background-music');
        const buttonSound = document.getElementById('button-sound');
        const borderOverlay = document.getElementById('border-overlay');
        const instructionsBtn = document.getElementById('instructions-btn');
        const instructionsPanel = document.getElementById('instructions-panel');
        const closeInstructions = document.getElementById('close-instructions');
        const menuToggle = document.getElementById('menu-toggle');
        const topMenu = document.getElementById('top-menu');
        const menuGrid15Btn = document.getElementById('menu-grid-15');
        const menuGrid20Btn = document.getElementById('menu-grid-20');
        const menuGrid25Btn = document.getElementById('menu-grid-25');
        const currentGridSize = document.getElementById('current-grid-size');
        const menuStartBtn = document.getElementById('menu-start-btn');
        const menuPauseBtn = document.getElementById('menu-pause-btn');
        const menuRestartBtn = document.getElementById('menu-restart-btn');
        const menuInstructionsBtn = document.getElementById('menu-instructions-btn');
        const menuMusicToggle = document.getElementById('menu-music-toggle');
        const menuVolumeDown = document.getElementById('menu-volume-down');
        const menuVolumeUp = document.getElementById('menu-volume-up');
        
        // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥—Ä—ã - –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä 20x20
        let gridSize = 20; // –†–∞–∑–º–µ—Ä –æ–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
        let gridWidth = 20;  // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–µ—Ç–æ–∫ –ø–æ —à–∏—Ä–∏–Ω–µ
        let gridHeight = 20; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–µ—Ç–æ–∫ –ø–æ –≤—ã—Å–æ—Ç–µ
        
        // –†–∞–∑–º–µ—Ä—ã canvas (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
        const canvasSize = 400; // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä canvas
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ canvas
        canvas.width = canvasSize;
        canvas.height = canvasSize;
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let snake = [];
        let food = {};
        let direction = 'right';
        let nextDirection = 'right';
        let gameSpeed = 150;
        let score = 0;
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        let gameRunning = false;
        let gamePaused = false;
        let gameLoop;
        let musicEnabled = true;
        let musicVolume = 0.7;
        let userInteracted = false; // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let gameRestarted = false; // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã
        
        // –¶–≤–µ—Ç–∞ —Ñ—Ä—É–∫—Ç–æ–≤: –∂—ë–ª—Ç—ã–π, –æ—Ä–∞–Ω–∂–µ–≤—ã–π, –∫—Ä–∞—Å–Ω—ã–π, –∑–µ–ª—ë–Ω—ã–π, —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π, —Å–∏–Ω–∏–π, –≥–æ–ª—É–±–æ–π
        const fruitColors = [
            {color: '#FFD700', points: 10, type: 'yellow'},    // –ñ—ë–ª—Ç—ã–π
            {color: '#FFA500', points: 10, type: 'orange'},    // –û—Ä–∞–Ω–∂–µ–≤—ã–π
            {color: '#FF0000', points: 10, type: 'red'},       // –ö—Ä–∞—Å–Ω—ã–π
            {color: '#00FF00', points: 10, type: 'green'},     // –ó–µ–ª—ë–Ω—ã–π
            {color: '#800080', points: 10, type: 'purple'},    // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π
            {color: '#0000FF', points: 10, type: 'blue'},      // –°–∏–Ω–∏–π
            {color: '#00FFFF', points: 10, type: 'cyan'}       // –ì–æ–ª—É–±–æ–π
        ];
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –∫–Ω–æ–ø–∫–∏
        function playButtonSound() {
            buttonSound.currentTime = 0;
            buttonSound.volume = 0.3;
            buttonSound.play().catch(e => console.log("–ó–≤—É–∫ –∫–Ω–æ–ø–∫–∏ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω:", e));
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–Ω—é
        function toggleMenu() {
            topMenu.classList.toggle('active');
            menuToggle.classList.toggle('active');
            
            if (topMenu.classList.contains('active')) {
                menuToggle.innerHTML = '‚úï';
            } else {
                menuToggle.innerHTML = '‚ò∞';
            }
            
            playButtonSound();
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é
        function closeMenu() {
            topMenu.classList.remove('active');
            menuToggle.classList.remove('active');
            menuToggle.innerHTML = '‚ò∞';
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–º–µ–π–∫–∏ - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º —Ü–µ–ª—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
            snake = [
                {x: Math.floor(gridWidth / 4), y: Math.floor(gridHeight / 2)},
                {x: Math.floor(gridWidth / 4) - 1, y: Math.floor(gridHeight / 2)},
                {x: Math.floor(gridWidth / 4) - 2, y: Math.floor(gridHeight / 2)}
            ];
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π –µ–¥—ã
            createFood();
            
            // –°–±—Ä–æ—Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            direction = 'right';
            nextDirection = 'right';
            
            // –°–±—Ä–æ—Å —Å—á–µ—Ç–∞
            score = 0;
            scoreElement.textContent = score;
            highScoreElement.textContent = highScore;
            
            // –°–±—Ä–æ—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Å–µ—Ç–∫–∏)
            gameSpeed = calculateGameSpeed();
            
            // –°–∫—Ä—ã—Ç–∏–µ —ç–∫—Ä–∞–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
            gameOverScreen.style.display = 'none';
            startHint.style.display = 'none';
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–∫–∏
            createGridOverlay();
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            draw();
        }
        
        // –†–∞—Å—á–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–≥—Ä—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Å–µ—Ç–∫–∏
        function calculateGameSpeed() {
            if (gridWidth === 15) return 180; // –°–∞–º–∞—è –º–µ–¥–ª–µ–Ω–Ω–∞—è –¥–ª—è –º–∞–ª–µ–Ω—å–∫–æ–π —Å–µ—Ç–∫–∏
            if (gridWidth === 20) return 150; // –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å
            if (gridWidth === 25) return 120; // –°–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è –¥–ª—è –±–æ–ª—å—à–æ–π —Å–µ—Ç–∫–∏
            return 150;
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–∫–∏ —Å —Ç–æ—á–Ω—ã–º –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º
        function createGridOverlay() {
            borderOverlay.innerHTML = '';
            
            // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫–ª–µ—Ç–∫–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
            gridSize = canvasSize / gridWidth;
            
            // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let i = 0; i <= gridWidth; i++) {
                const line = document.createElement('div');
                line.className = 'border-line';
                line.style.width = '1px';
                line.style.height = '100%';
                line.style.left = `${(i * gridSize)}px`;
                borderOverlay.appendChild(line);
            }
            
            // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let i = 0; i <= gridHeight; i++) {
                const line = document.createElement('div');
                line.className = 'border-line';
                line.style.height = '1px';
                line.style.width = '100%';
                line.style.top = `${(i * gridSize)}px`;
                borderOverlay.appendChild(line);
            }
        }
        
        // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–µ—Ç–∫–∏
        function changeGridSize(size) {
            playButtonSound();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã —Å–µ—Ç–∫–∏
            gridWidth = size;
            gridHeight = size;
            
            // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫–ª–µ—Ç–∫–∏
            gridSize = canvasSize / size;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
            currentGridSize.textContent = `–†–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏: ${size} √ó ${size}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –≤ –º–µ–Ω—é
            document.querySelectorAll('.menu-btn.grid-size-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (size === 15) menuGrid15Btn.classList.add('active');
            if (size === 20) menuGrid20Btn.classList.add('active');
            if (size === 25) menuGrid25Btn.classList.add('active');
            
            // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É —Å –Ω–æ–≤—ã–º —Ä–∞–∑–º–µ—Ä–æ–º
            if (gameRunning) {
                clearInterval(gameLoop);
                initGame();
                gameLoop = setInterval(updateGame, gameSpeed);
            } else {
                initGame();
            }
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
            closeMenu();
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –µ–¥—ã - –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤ —Ü–µ–Ω—Ç—Ä–µ –∫–ª–µ—Ç–∫–∏
        function createFood() {
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Ü–µ–ª—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è –µ–¥—ã –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å–µ—Ç–∫–∏
            food = {
                x: Math.floor(Math.random() * gridWidth),
                y: Math.floor(Math.random() * gridHeight),
                type: Math.floor(Math.random() * fruitColors.length)
            };
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω–µ –ø–æ—è–≤–∏–ª–∞—Å—å –ª–∏ –µ–¥–∞ –Ω–∞ –∑–º–µ–π–∫–µ
            for (let segment of snake) {
                if (segment.x === food.x && segment.y === food.y) {
                    return createFood();
                }
            }
        }
        
        // –†–∏—Å–æ–≤–∞–Ω–∏–µ –∏–≥—Ä—ã —Å —Ç–æ—á–Ω—ã–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        function draw() {
            // –û—á–∏—Å—Ç–∫–∞ —Ö–æ–ª—Å—Ç–∞
            ctx.fillStyle = '#0d2818';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –†–∏—Å–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (–æ—á–µ–Ω—å —Å–≤–µ—Ç–ª–∞—è) - —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –≤–∏–∑—É–∞–ª—å–Ω–æ–π —Å–µ—Ç–∫–æ–π
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
            ctx.lineWidth = 0.5;
            
            // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let x = 0; x <= gridWidth; x++) {
                ctx.beginPath();
                ctx.moveTo(x * gridSize, 0);
                ctx.lineTo(x * gridSize, canvas.height);
                ctx.stroke();
            }
            
            // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let y = 0; y <= gridHeight; y++) {
                ctx.beginPath();
                ctx.moveTo(0, y * gridSize);
                ctx.lineTo(canvas.width, y * gridSize);
                ctx.stroke();
            }
            
            // –†–∏—Å–æ–≤–∞–Ω–∏–µ –∑–º–µ–π–∫–∏ —Å —Ç–æ—á–Ω—ã–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
            snake.forEach((segment, index) => {
                // –í—ã—á–∏—Å–ª—è–µ–º —Ç–æ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
                const x = segment.x * gridSize;
                const y = segment.y * gridSize;
                
                // –ì–æ–ª–æ–≤–∞ –∑–º–µ–π–∫–∏
                if (index === 0) {
                    ctx.fillStyle = '#ffd166';
                    // –†–∏—Å—É–µ–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Ç–æ—á–Ω–æ –ø–æ –≥—Ä–∞–Ω–∏—Ü–∞–º –∫–ª–µ—Ç–∫–∏
                    ctx.fillRect(x, y, gridSize, gridSize);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Ä–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–π –∫–æ–ª–ø–∞—á–æ–∫ –Ω–∞ –≥–æ–ª–æ–≤—É (–≤—Å–µ–≥–¥–∞ —Å–≤–µ—Ä—Ö—É, –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
                    if (gridSize >= 15) {
                        ctx.fillStyle = '#d90429';
                        ctx.beginPath();
                        ctx.moveTo(x, y);
                        ctx.lineTo(x + gridSize/2, y - gridSize/3);
                        ctx.lineTo(x + gridSize, y);
                        ctx.closePath();
                        ctx.fill();
                        
                        // –®–∞—Ä–∏–∫ –Ω–∞ –∫–æ–ª–ø–∞—á–∫–µ
                        ctx.fillStyle = '#06d6a0';
                        ctx.beginPath();
                        ctx.arc(x + gridSize/2, y - gridSize/3, gridSize/6, 0, Math.PI * 2);
                        ctx.fill();
                    }
                    
                    // –ì–ª–∞–∑–∞ –∑–º–µ–π–∫–∏ (–≤—Å–µ–≥–¥–∞ —Å–º–æ—Ç—Ä—è—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—É –¥–≤–∏–∂–µ–Ω–∏—è)
                    if (gridSize >= 12) {
                        ctx.fillStyle = '#0d2818';
                        const eyeSize = gridSize / 5;
                        
                        // –ü–æ–∑–∏—Ü–∏—è –≥–ª–∞–∑ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                        let leftEyeX, leftEyeY, rightEyeX, rightEyeY;
                        
                        if (direction === 'right') {
                            leftEyeX = x + gridSize - eyeSize * 2;
                            leftEyeY = y + eyeSize * 2;
                            rightEyeX = x + gridSize - eyeSize * 2;
                            rightEyeY = y + gridSize - eyeSize * 3;
                        } else if (direction === 'left') {
                            leftEyeX = x + eyeSize;
                            leftEyeY = y + eyeSize * 2;
                            rightEyeX = x + eyeSize;
                            rightEyeY = y + gridSize - eyeSize * 3;
                        } else if (direction === 'up') {
                            leftEyeX = x + eyeSize * 2;
                            leftEyeY = y + eyeSize;
                            rightEyeX = x + gridSize - eyeSize * 3;
                            rightEyeY = y + eyeSize;
                        } else { // down
                            leftEyeX = x + eyeSize * 2;
                            leftEyeY = y + gridSize - eyeSize * 2;
                            rightEyeX = x + gridSize - eyeSize * 3;
                            rightEyeY = y + gridSize - eyeSize * 2;
                        }
                        
                        // –†–∏—Å—É–µ–º –≥–ª–∞–∑–∞
                        ctx.fillRect(leftEyeX, leftEyeY, eyeSize, eyeSize);
                        ctx.fillRect(rightEyeX, rightEyeY, eyeSize, eyeSize);
                    }
                } 
                // –¢–µ–ª–æ –∑–º–µ–π–∫–∏
                else {
                    // –ß–µ—Ä–µ–¥—É–µ–º —Ü–≤–µ—Ç–∞ –¥–ª—è —Ä–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
                    if (index % 2 === 0) {
                        ctx.fillStyle = '#d90429'; // –ö—Ä–∞—Å–Ω—ã–π
                    } else {
                        ctx.fillStyle = '#06d6a0'; // –ó–µ–ª–µ–Ω—ã–π
                    }
                    
                    // –†–∏—Å—É–µ–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Ç–æ—á–Ω–æ –ø–æ –≥—Ä–∞–Ω–∏—Ü–∞–º –∫–ª–µ—Ç–∫–∏
                    ctx.fillRect(x, y, gridSize, gridSize);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —É–∑–æ—Ä –Ω–∞ —Ç–µ–ª–æ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∞—è)
                    if (gridSize >= 12) {
                        ctx.fillStyle = '#ffd166';
                        ctx.fillRect(x + 2, y + 2, gridSize - 4, gridSize - 4);
                    }
                }
            });
            
            // –†–∏—Å–æ–≤–∞–Ω–∏–µ —Ñ—Ä—É–∫—Ç–∞ —Å —Ç–æ—á–Ω—ã–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤ —Ü–µ–Ω—Ç—Ä–µ –∫–ª–µ—Ç–∫–∏
            const fruit = fruitColors[food.type];
            const foodX = food.x * gridSize;
            const foodY = food.y * gridSize;
            const foodCenterX = foodX + gridSize / 2;
            const foodCenterY = foodY + gridSize / 2;
            
            // –†–∏—Å—É–µ–º —Ñ—Ä—É–∫—Ç —Ç–æ—á–Ω–æ –≤ —Ü–µ–Ω—Ç—Ä–µ –∫–ª–µ—Ç–∫–∏
            ctx.fillStyle = fruit.color;
            ctx.beginPath();
            // –û–∫—Ä—É–∂–Ω–æ—Å—Ç—å —Ç–æ—á–Ω–æ –ø–æ —Ü–µ–Ω—Ç—Ä—É –∫–ª–µ—Ç–∫–∏
            ctx.arc(foodCenterX, foodCenterY, gridSize / 2 - 1, 0, Math.PI * 2);
            ctx.fill();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –±–ª–∏–∫ –Ω–∞ —Ñ—Ä—É–∫—Ç (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∞—è)
            if (gridSize >= 15) {
                ctx.fillStyle = '#ffffff80';
                ctx.beginPath();
                ctx.arc(foodCenterX - 2, foodCenterY - 2, gridSize / 6, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º –¥–≤–∏–∂–µ–Ω–∏–µ–º
        function update() {
            if (gamePaused) return;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            direction = nextDirection;
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥–æ–ª–æ–≤—ã –∑–º–µ–π–∫–∏ - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º —Ü–µ–ª—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
            const head = {...snake[0]};
            
            // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ 1 –∫–ª–µ—Ç–∫—É
            switch(direction) {
                case 'up':
                    head.y -= 1;
                    break;
                case 'down':
                    head.y += 1;
                    break;
                case 'left':
                    head.x -= 1;
                    break;
                case 'right':
                    head.x += 1;
                    break;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å–æ —Å—Ç–µ–Ω–∞–º–∏
            if (head.x < 0 || head.x >= gridWidth || head.y < 0 || head.y >= gridHeight) {
                gameOver();
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Å–æ–±–æ–π
            for (let segment of snake) {
                if (head.x === segment.x && head.y === segment.y) {
                    gameOver();
                    return;
                }
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –≥–æ–ª–æ–≤—ã
            snake.unshift(head);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞, —Å—ä–µ–ª–∞ –ª–∏ –∑–º–µ–π–∫–∞ –µ–¥—É - —Ç–æ—á–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–ª—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
            if (head.x === food.x && head.y === food.y) {
                // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ—Ä—É–∫—Ç–µ
                const fruit = fruitColors[food.type];
                
                // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç–∞ - –≤—Å–µ–≥–¥–∞ 10 –æ—á–∫–æ–≤
                score += fruit.points;
                scoreElement.textContent = score;
                
                // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –ø—Ä–∏ —Å—ä–µ–¥–∞–Ω–∏–∏ –µ–¥—ã
                playEatSound();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–æ—Ä–¥–∞
                if (score > highScore) {
                    highScore = score;
                    highScoreElement.textContent = highScore;
                    localStorage.setItem('snakeHighScore', highScore);
                }
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –µ–¥—ã
                createFood();
                
                // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∫–∞–∂–¥—ã–µ 50 –æ—á–∫–æ–≤
                if (score % 50 === 0 && gameSpeed > 50) {
                    gameSpeed -= 20;
                    clearInterval(gameLoop);
                    gameLoop = setInterval(updateGame, gameSpeed);
                }
            } else {
                // –£–¥–∞–ª–µ–Ω–∏–µ —Ö–≤–æ—Å—Ç–∞, –µ—Å–ª–∏ –µ–¥–∞ –Ω–µ —Å—ä–µ–¥–µ–Ω–∞
                snake.pop();
            }
        }
        
        // –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function updateGame() {
            update();
            draw();
        }
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        function gameOver() {
            gameRunning = false;
            gameRestarted = false;
            clearInterval(gameLoop);
            
            // –ü–æ–∫–∞–∑ —ç–∫—Ä–∞–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
            finalScoreElement.textContent = `–í–∞—à —Å—á–µ—Ç: ${score}`;
            gameOverScreen.style.display = 'flex';
            startHint.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–æ—Ä–¥–∞
            if (score > highScore) {
                highScore = score;
                highScoreElement.textContent = highScore;
                localStorage.setItem('snakeHighScore', highScore);
            }
        }
        
        // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
        function startGame() {
            if (gameRunning) return;
            
            // –ü–æ–º–µ—á–∞–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª
            userInteracted = true;
            
            // –ï—Å–ª–∏ –∏–≥—Ä–∞ –±—ã–ª–∞ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
            if (gameRestarted) {
                startHint.style.display = 'block';
            }
            
            initGame();
            gameRunning = true;
            gamePaused = false;
            
            // –ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
            clearInterval(gameLoop);
            gameLoop = setInterval(updateGame, gameSpeed);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏ –≤ –º–µ–Ω—é
            menuStartBtn.textContent = '–ò–≥—Ä–∞ –∏–¥–µ—Ç...';
            
            // –ó–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞
            if (musicEnabled && userInteracted) {
                backgroundMusic.play().catch(e => {
                    console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º—É–∑—ã–∫–∏:", e);
                    // –ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ, –ø–æ–∫–∞–∂–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                    menuMusicToggle.textContent = 'üîá –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –º—É–∑—ã–∫–∏';
                });
            }
            
            playButtonSound();
            closeMenu();
        }
        
        // –ü–∞—É–∑–∞ –∏–≥—Ä—ã
        function pauseGame() {
            if (!gameRunning) return;
            
            gamePaused = !gamePaused;
            
            if (gamePaused) {
                menuPauseBtn.textContent = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
                
                // –ü–∞—É–∑–∞ –º—É–∑—ã–∫–∏
                backgroundMusic.pause();
            } else {
                menuPauseBtn.textContent = '–ü–∞—É–∑–∞';
                
                // –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º—É–∑—ã–∫–∏
                if (musicEnabled) {
                    backgroundMusic.play().catch(e => console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º—É–∑—ã–∫–∏:", e));
                }
            }
            
            playButtonSound();
            closeMenu();
        }
        
        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        function restartGame() {
            clearInterval(gameLoop);
            initGame();
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
            gameRestarted = true;
            
            if (gameRunning) {
                gameLoop = setInterval(updateGame, gameSpeed);
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
            startHint.style.display = 'block';
            
            playButtonSound();
            closeMenu();
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º—É–∑—ã–∫–æ–π
        function toggleMusic() {
            userInteracted = true;
            musicEnabled = !musicEnabled;
            
            if (musicEnabled) {
                backgroundMusic.play().catch(e => console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º—É–∑—ã–∫–∏:", e));
                menuMusicToggle.textContent = 'üîä –ú—É–∑—ã–∫–∞ –í–ö–õ';
            } else {
                backgroundMusic.pause();
                menuMusicToggle.textContent = 'üîá –ú—É–∑—ã–∫–∞ –í–´–ö–õ';
            }
            
            playButtonSound();
            closeMenu();
        }
        
        function adjustVolume(change) {
            userInteracted = true;
            musicVolume = Math.max(0, Math.min(1, musicVolume + change));
            backgroundMusic.volume = musicVolume;
            
            // –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
            if (change > 0) {
                menuVolumeUp.style.backgroundColor = '#06d6a0';
                setTimeout(() => {
                    menuVolumeUp.style.backgroundColor = '';
                }, 200);
            } else {
                menuVolumeDown.style.backgroundColor = '#06d6a0';
                setTimeout(() => {
                    menuVolumeDown.style.backgroundColor = '';
                }, 200);
            }
            
            playButtonSound();
            closeMenu();
        }
        
        // –ó–≤—É–∫ –ø—Ä–∏ —Å—ä–µ–¥–∞–Ω–∏–∏ –µ–¥—ã
        function playEatSound() {
            // –ü—Ä–æ—Å—Ç–æ–π –∑–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (e) {
                console.log("–ó–≤—É–∫ —Å—ä–µ–¥–∞–Ω–∏—è –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω:", e);
            }
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        function handleKeyDown(e) {
            // –ü–æ–º–µ—á–∞–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª
            userInteracted = true;
            
            // –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥ –∫–ª–∞–≤–∏—à–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
            const key = e.key.toLowerCase();
            
            // –ö–∞—Ä—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∫–ª–∞–≤–∏—à –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞—Å–∫–ª–∞–¥–æ–∫
            const keyMap = {
                // –ê–Ω–≥–ª–∏–π—Å–∫–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞
                'arrowup': 'up',
                'arrowdown': 'down', 
                'arrowleft': 'left',
                'arrowright': 'right',
                'w': 'up',
                's': 'down',
                'a': 'left',
                'd': 'right',
                
                // –†—É—Å—Å–∫–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞ (–§–¶–´–í)
                '—Ü': 'up',    // W -> –¶
                '—ã': 'down',  // S -> –´
                '—Ñ': 'left',  // A -> –§
                '–≤': 'right'  // D -> –í
            };
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∫–ª–∞–≤–∏—à–∞ –≤ –∫–∞—Ä—Ç–µ
            if (keyMap[key] !== undefined) {
                const mappedDirection = keyMap[key];
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–º —Ç–µ–∫—É—â–µ–º—É
                if ((mappedDirection === 'up' && direction !== 'down') ||
                    (mappedDirection === 'down' && direction !== 'up') ||
                    (mappedDirection === 'left' && direction !== 'right') ||
                    (mappedDirection === 'right' && direction !== 'left')) {
                    nextDirection = mappedDirection;
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∞–≤–∏—à
            switch(key) {
                case ' ':
                    // –ü—Ä–æ–±–µ–ª –¥–ª—è –ø–∞—É–∑—ã/—Å—Ç–∞—Ä—Ç–∞
                    e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                    if (!gameRunning) {
                        startGame();
                    } else {
                        pauseGame();
                    }
                    break;
                case 'enter':
                    // Enter –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
                    restartGame();
                    break;
                case 'escape':
                    // Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏ –º–µ–Ω—é
                    instructionsPanel.classList.remove('active');
                    closeMenu();
                    break;
            }
        }
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
        function openInstructions() {
            instructionsPanel.classList.add('active');
            playButtonSound();
            closeMenu();
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        function setupButtonControls() {
            // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–π (–º–µ–Ω—é)
            menuStartBtn.addEventListener('click', startGame);
            menuPauseBtn.addEventListener('click', pauseGame);
            menuRestartBtn.addEventListener('click', restartGame);
            restartBtn.addEventListener('click', restartGame);
            
            // –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å–µ—Ç–∫–∏ (–º–µ–Ω—é)
            menuGrid15Btn.addEventListener('click', () => changeGridSize(15));
            menuGrid20Btn.addEventListener('click', () => changeGridSize(20));
            menuGrid25Btn.addEventListener('click', () => changeGridSize(25));
            
            // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º—É–∑—ã–∫–æ–π (–º–µ–Ω—é)
            menuMusicToggle.addEventListener('click', toggleMusic);
            menuVolumeDown.addEventListener('click', () => adjustVolume(-0.1));
            menuVolumeUp.addEventListener('click', () => adjustVolume(0.1));
            
            // –ö–Ω–æ–ø–∫–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
            instructionsBtn.addEventListener('click', openInstructions);
            
            // –ö–Ω–æ–ø–∫–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (–º–µ–Ω—é)
            menuInstructionsBtn.addEventListener('click', openInstructions);
            
            // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–Ω—é
            menuToggle.addEventListener('click', toggleMenu);
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
            closeInstructions.addEventListener('click', () => {
                instructionsPanel.classList.remove('active');
                playButtonSound();
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–µ
            document.addEventListener('click', (e) => {
                if (instructionsPanel.classList.contains('active') && 
                    !instructionsPanel.contains(e.target) && 
                    e.target !== instructionsBtn && 
                    e.target !== menuInstructionsBtn) {
                    instructionsPanel.classList.remove('active');
                }
                
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ (–∫—Ä–æ–º–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é)
                if (topMenu.classList.contains('active') && 
                    !topMenu.contains(e.target) && 
                    e.target !== menuToggle) {
                    closeMenu();
                }
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Escape
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && topMenu.classList.contains('active')) {
                    closeMenu();
                }
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', () => {
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–≥—Ä—ã
            initGame();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º—É–∑—ã–∫–∏
            backgroundMusic.volume = musicVolume;
            
            // –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º—É–∑—ã–∫–∏
            backgroundMusic.load();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            setupButtonControls();
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–∫–æ—Ä–¥–∞
            highScoreElement.textContent = highScore;
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∞–≤–∏—à
            document.addEventListener('keydown', handleKeyDown);
            
            // –†–∞–∑—Ä–µ—à–∞–µ–º –º—É–∑—ã–∫—É –ø—Ä–∏ –ª—é–±–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–º
            document.addEventListener('click', function enableAudio() {
                userInteracted = true;
                document.removeEventListener('click', enableAudio);
            });
        });
    </script>
</body>
</html>